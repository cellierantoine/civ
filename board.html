<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Civ</title>
        <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
        <style type="text/css">
            body {
                margin: 0;
            }
        </style>
    </head>
    <body>
        <script src="tile.js"></script>
        <script src="event.js"></script>
        <script src="resource.js"></script>
        <script src="construction.js"></script>
        <script type="text/javascript">
            var TILE_SIZE = 32;
            var TILE_ASPECT = 1;
            var LEVEL_SIZE = 21;
            var TOP_BAR_SIZE = 64;
            var SIDE_BAR_SIZE = 200;


            var game = new Phaser.Game(872, 736, Phaser.AUTO, '', { preload: preload, create: create, update: update });


            function preload() {
                game.load.image('background', 'assets/background.png');
                game.load.image('grass', 'assets/grass.png');
                game.load.image('water', 'assets/water.png');
                game.load.image('selector', 'assets/selector.png');
                game.load.image('house', 'assets/house.png');
            }


            var ground = [];
            var start;
            var selector;



            function create() {
                //SPRITE
                game.add.sprite(0, 0, 'background');
                mapBeach(ground);

                //SELECTOR
                selector = new Selector();

                document.addEventListener("click", function(event){ click(event, ground, selector); });

                //start time
                start = game.time.now;

                let sprite = game.add.sprite(701, 108, 'house');
                console.log(sprite.width +" // "+sprite.height)
                sprite.width = sprite.width*2;
                sprite.height = sprite.height*2;
                sprite.smoothed = false;

            }

            function update() {
                if(game.time.now > start+5000){
                    //flood(ground);
                    start = game.time.now;
                }
            }

            function click(event, ground, selector){
                if(event.clientX < 872- SIDE_BAR_SIZE && event.clientY > TOP_BAR_SIZE){
                    selector.moveSelector(event, ground);
                }else if(selector.tileSelected != null && event.clientX > 701 && event.clientX < 701+67 && event.clientY > 108 && event.clientY < 108+67){
                    selector.tileSelected.buildHouse();
                }
            }


        </script>

    </body>
</html>